{"ast":null,"code":"import { combineLatest, filter, map, Subject, takeUntil } from 'rxjs';\nimport { SocketEventsEnum } from 'src/app/shared/types/socketEvents.enum';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/board.service\";\nimport * as i3 from \"src/app/shared/services/tasks.service\";\nimport * as i4 from \"src/app/shared/services/socket.service\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"../../../shared/modules/inlineForm/components/inlineForm/inlineForm.component\";\n\nfunction TaskModalComponent_div_0_option_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const column_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", column_r3.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", column_r3.title, \" \");\n  }\n}\n\nfunction TaskModalComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"div\", 3)(2, \"inline-form\", 4);\n    i0.ɵɵlistener(\"handleSubmit\", function TaskModalComponent_div_0_Template_inline_form_handleSubmit_2_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.updateTaskName($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"img\", 5);\n    i0.ɵɵlistener(\"click\", function TaskModalComponent_div_0_Template_img_click_3_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.goToBoard();\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"div\", 6)(5, \"div\")(6, \"form\", 7)(7, \"select\", 8);\n    i0.ɵɵtemplate(8, TaskModalComponent_div_0_option_8_Template, 2, 2, \"option\", 9);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 10)(10, \"div\", 11);\n    i0.ɵɵtext(11, \"Description\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"inline-form\", 12);\n    i0.ɵɵlistener(\"handleSubmit\", function TaskModalComponent_div_0_Template_inline_form_handleSubmit_12_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.updateTaskDescription($event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(13, \"div\", 13)(14, \"div\", 14);\n    i0.ɵɵtext(15, \"Actions\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"div\")(17, \"div\", 15);\n    i0.ɵɵlistener(\"click\", function TaskModalComponent_div_0_Template_div_click_17_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.deleteTask();\n    });\n    i0.ɵɵelement(18, \"img\", 16);\n    i0.ɵɵtext(19, \" Delete \");\n    i0.ɵɵelementEnd()()()()();\n  }\n\n  if (rf & 2) {\n    const data_r1 = ctx.ngIf;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"defaultText\", data_r1.task.title)(\"title\", data_r1.task.title);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.columnForm);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", data_r1.columns);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"defaultText\", data_r1.task.description || \"Add a more detailed description\")(\"title\", data_r1.task.description || \"\")(\"hasButton\", true);\n  }\n}\n\nexport class TaskModalComponent {\n  constructor(route, router, boardService, tasksService, socketService, fb) {\n    var _a;\n\n    this.route = route;\n    this.router = router;\n    this.boardService = boardService;\n    this.tasksService = tasksService;\n    this.socketService = socketService;\n    this.fb = fb;\n    this.classes = 'task-modal';\n    this.columnForm = this.fb.group({\n      columnId: [null]\n    });\n    this.unsubscribe$ = new Subject();\n    const taskId = this.route.snapshot.paramMap.get('taskId');\n    const boardId = (_a = this.route.parent) === null || _a === void 0 ? void 0 : _a.snapshot.paramMap.get('boardId');\n\n    if (!boardId) {\n      throw new Error(\"Can't get boardID from URL\");\n    }\n\n    if (!taskId) {\n      throw new Error(\"Can't get taskID from URL\");\n    }\n\n    this.taskId = taskId;\n    this.boardId = boardId;\n    this.task$ = this.boardService.tasks$.pipe(map(tasks => {\n      return tasks.find(task => task.id === this.taskId);\n    }), filter(Boolean));\n    this.data$ = combineLatest([this.task$, this.boardService.columns$]).pipe(map(([task, columns]) => ({\n      task,\n      columns\n    })));\n    this.task$.pipe(takeUntil(this.unsubscribe$)).subscribe(task => {\n      this.columnForm.patchValue({\n        columnId: task.columnId\n      });\n    });\n    combineLatest([this.task$, this.columnForm.get('columnId').valueChanges]).pipe(takeUntil(this.unsubscribe$)).subscribe(([task, columnId]) => {\n      if (task.columnId !== columnId) {\n        this.tasksService.updateTask(this.boardId, task.id, {\n          columnId\n        });\n      }\n    });\n    this.socketService.listen(SocketEventsEnum.tasksDeleteSuccess).pipe(takeUntil(this.unsubscribe$)).subscribe(() => {\n      this.goToBoard();\n    });\n  }\n\n  ngOnDestroy() {\n    this.unsubscribe$.next();\n    this.unsubscribe$.complete();\n  }\n\n  goToBoard() {\n    this.router.navigate(['boards', this.boardId]);\n  }\n\n  updateTaskName(taskName) {\n    this.tasksService.updateTask(this.boardId, this.taskId, {\n      title: taskName\n    });\n  }\n\n  updateTaskDescription(taskDesctiption) {\n    this.tasksService.updateTask(this.boardId, this.taskId, {\n      description: taskDesctiption\n    });\n  }\n\n  deleteTask() {\n    this.tasksService.deleteTask(this.boardId, this.taskId);\n  }\n\n}\n\nTaskModalComponent.ɵfac = function TaskModalComponent_Factory(t) {\n  return new (t || TaskModalComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.BoardService), i0.ɵɵdirectiveInject(i3.TasksService), i0.ɵɵdirectiveInject(i4.SocketService), i0.ɵɵdirectiveInject(i5.FormBuilder));\n};\n\nTaskModalComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: TaskModalComponent,\n  selectors: [[\"task-modal\"]],\n  hostVars: 2,\n  hostBindings: function TaskModalComponent_HostBindings(rf, ctx) {\n    if (rf & 2) {\n      i0.ɵɵclassMap(ctx.classes);\n    }\n  },\n  decls: 3,\n  vars: 3,\n  consts: [[\"class\", \"task-modal-container\", 4, \"ngIf\"], [1, \"task-modal-backdrop\"], [1, \"task-modal-container\"], [1, \"task-modal-header\"], [1, \"task-modal-edit-title-form\", 3, \"defaultText\", \"title\", \"handleSubmit\"], [\"src\", \"/assets/close_icon.svg\", 1, \"task-modal-close\", 3, \"click\"], [1, \"task-modal-body\"], [1, \"column-select-container\", 3, \"formGroup\"], [\"formControlName\", \"columnId\", 1, \"column-select\"], [3, \"ngValue\", 4, \"ngFor\", \"ngForOf\"], [1, \"task-modal-description\"], [1, \"task-modal-description-label\"], [\"inputType\", \"textarea\", \"buttonText\", \"Save\", 1, \"task-modal-edit-description-form\", 3, \"defaultText\", \"title\", \"hasButton\", \"handleSubmit\"], [1, \"task-modal-actions\"], [1, \"task-modal-actions-label\"], [1, \"task-modal-actions-action\", 3, \"click\"], [\"src\", \"/assets/trash.svg\", 1, \"task-modal-actions-icon\"], [3, \"ngValue\"]],\n  template: function TaskModalComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, TaskModalComponent_div_0_Template, 20, 7, \"div\", 0);\n      i0.ɵɵpipe(1, \"async\");\n      i0.ɵɵelement(2, \"div\", 1);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(1, 1, ctx.data$));\n    }\n  },\n  directives: [i6.NgIf, i7.InlineFormComponent, i5.ɵNgNoValidate, i5.NgControlStatusGroup, i5.FormGroupDirective, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.FormControlName, i6.NgForOf, i5.NgSelectOption, i5.ɵNgSelectMultipleOption],\n  pipes: [i6.AsyncPipe],\n  encapsulation: 2\n});","map":{"version":3,"sources":["/Users/inmac/Downloads/trello-socket-io-47-deployment/client/src/app/board/components/taskModal/taskModal.component.ts"],"names":["combineLatest","filter","map","Subject","takeUntil","SocketEventsEnum","i0","i1","i2","i3","i4","i5","i6","i7","TaskModalComponent_div_0_option_8_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","column_r3","$implicit","ɵɵproperty","id","ɵɵadvance","ɵɵtextInterpolate1","title","TaskModalComponent_div_0_Template","_r5","ɵɵgetCurrentView","ɵɵlistener","TaskModalComponent_div_0_Template_inline_form_handleSubmit_2_listener","$event","ɵɵrestoreView","ctx_r4","ɵɵnextContext","updateTaskName","TaskModalComponent_div_0_Template_img_click_3_listener","ctx_r6","goToBoard","ɵɵtemplate","TaskModalComponent_div_0_Template_inline_form_handleSubmit_12_listener","ctx_r7","updateTaskDescription","TaskModalComponent_div_0_Template_div_click_17_listener","ctx_r8","deleteTask","ɵɵelement","data_r1","ngIf","ctx_r0","task","columnForm","columns","description","TaskModalComponent","constructor","route","router","boardService","tasksService","socketService","fb","_a","classes","group","columnId","unsubscribe$","taskId","snapshot","paramMap","get","boardId","parent","Error","task$","tasks$","pipe","tasks","find","Boolean","data$","columns$","subscribe","patchValue","valueChanges","updateTask","listen","tasksDeleteSuccess","ngOnDestroy","next","complete","navigate","taskName","taskDesctiption","ɵfac","TaskModalComponent_Factory","t","ɵɵdirectiveInject","ActivatedRoute","Router","BoardService","TasksService","SocketService","FormBuilder","ɵcmp","ɵɵdefineComponent","type","selectors","hostVars","hostBindings","TaskModalComponent_HostBindings","ɵɵclassMap","decls","vars","consts","template","TaskModalComponent_Template","ɵɵpipe","ɵɵpipeBind1","directives","NgIf","InlineFormComponent","ɵNgNoValidate","NgControlStatusGroup","FormGroupDirective","SelectControlValueAccessor","NgControlStatus","FormControlName","NgForOf","NgSelectOption","ɵNgSelectMultipleOption","pipes","AsyncPipe","encapsulation"],"mappings":"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","sourcesContent":["import { combineLatest, filter, map, Subject, takeUntil, } from 'rxjs';\nimport { SocketEventsEnum } from 'src/app/shared/types/socketEvents.enum';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/board.service\";\nimport * as i3 from \"src/app/shared/services/tasks.service\";\nimport * as i4 from \"src/app/shared/services/socket.service\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"../../../shared/modules/inlineForm/components/inlineForm/inlineForm.component\";\nfunction TaskModalComponent_div_0_option_8_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n} if (rf & 2) {\n    const column_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", column_r3.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", column_r3.title, \" \");\n} }\nfunction TaskModalComponent_div_0_Template(rf, ctx) { if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"div\", 3)(2, \"inline-form\", 4);\n    i0.ɵɵlistener(\"handleSubmit\", function TaskModalComponent_div_0_Template_inline_form_handleSubmit_2_listener($event) { i0.ɵɵrestoreView(_r5); const ctx_r4 = i0.ɵɵnextContext(); return ctx_r4.updateTaskName($event); });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"img\", 5);\n    i0.ɵɵlistener(\"click\", function TaskModalComponent_div_0_Template_img_click_3_listener() { i0.ɵɵrestoreView(_r5); const ctx_r6 = i0.ɵɵnextContext(); return ctx_r6.goToBoard(); });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"div\", 6)(5, \"div\")(6, \"form\", 7)(7, \"select\", 8);\n    i0.ɵɵtemplate(8, TaskModalComponent_div_0_option_8_Template, 2, 2, \"option\", 9);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 10)(10, \"div\", 11);\n    i0.ɵɵtext(11, \"Description\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"inline-form\", 12);\n    i0.ɵɵlistener(\"handleSubmit\", function TaskModalComponent_div_0_Template_inline_form_handleSubmit_12_listener($event) { i0.ɵɵrestoreView(_r5); const ctx_r7 = i0.ɵɵnextContext(); return ctx_r7.updateTaskDescription($event); });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(13, \"div\", 13)(14, \"div\", 14);\n    i0.ɵɵtext(15, \"Actions\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"div\")(17, \"div\", 15);\n    i0.ɵɵlistener(\"click\", function TaskModalComponent_div_0_Template_div_click_17_listener() { i0.ɵɵrestoreView(_r5); const ctx_r8 = i0.ɵɵnextContext(); return ctx_r8.deleteTask(); });\n    i0.ɵɵelement(18, \"img\", 16);\n    i0.ɵɵtext(19, \" Delete \");\n    i0.ɵɵelementEnd()()()()();\n} if (rf & 2) {\n    const data_r1 = ctx.ngIf;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"defaultText\", data_r1.task.title)(\"title\", data_r1.task.title);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.columnForm);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", data_r1.columns);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"defaultText\", data_r1.task.description || \"Add a more detailed description\")(\"title\", data_r1.task.description || \"\")(\"hasButton\", true);\n} }\nexport class TaskModalComponent {\n    constructor(route, router, boardService, tasksService, socketService, fb) {\n        var _a;\n        this.route = route;\n        this.router = router;\n        this.boardService = boardService;\n        this.tasksService = tasksService;\n        this.socketService = socketService;\n        this.fb = fb;\n        this.classes = 'task-modal';\n        this.columnForm = this.fb.group({\n            columnId: [null],\n        });\n        this.unsubscribe$ = new Subject();\n        const taskId = this.route.snapshot.paramMap.get('taskId');\n        const boardId = (_a = this.route.parent) === null || _a === void 0 ? void 0 : _a.snapshot.paramMap.get('boardId');\n        if (!boardId) {\n            throw new Error(\"Can't get boardID from URL\");\n        }\n        if (!taskId) {\n            throw new Error(\"Can't get taskID from URL\");\n        }\n        this.taskId = taskId;\n        this.boardId = boardId;\n        this.task$ = this.boardService.tasks$.pipe(map((tasks) => {\n            return tasks.find((task) => task.id === this.taskId);\n        }), filter(Boolean));\n        this.data$ = combineLatest([this.task$, this.boardService.columns$]).pipe(map(([task, columns]) => ({\n            task,\n            columns,\n        })));\n        this.task$.pipe(takeUntil(this.unsubscribe$)).subscribe((task) => {\n            this.columnForm.patchValue({ columnId: task.columnId });\n        });\n        combineLatest([this.task$, this.columnForm.get('columnId').valueChanges])\n            .pipe(takeUntil(this.unsubscribe$))\n            .subscribe(([task, columnId]) => {\n            if (task.columnId !== columnId) {\n                this.tasksService.updateTask(this.boardId, task.id, { columnId });\n            }\n        });\n        this.socketService\n            .listen(SocketEventsEnum.tasksDeleteSuccess)\n            .pipe(takeUntil(this.unsubscribe$))\n            .subscribe(() => {\n            this.goToBoard();\n        });\n    }\n    ngOnDestroy() {\n        this.unsubscribe$.next();\n        this.unsubscribe$.complete();\n    }\n    goToBoard() {\n        this.router.navigate(['boards', this.boardId]);\n    }\n    updateTaskName(taskName) {\n        this.tasksService.updateTask(this.boardId, this.taskId, {\n            title: taskName,\n        });\n    }\n    updateTaskDescription(taskDesctiption) {\n        this.tasksService.updateTask(this.boardId, this.taskId, {\n            description: taskDesctiption,\n        });\n    }\n    deleteTask() {\n        this.tasksService.deleteTask(this.boardId, this.taskId);\n    }\n}\nTaskModalComponent.ɵfac = function TaskModalComponent_Factory(t) { return new (t || TaskModalComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.BoardService), i0.ɵɵdirectiveInject(i3.TasksService), i0.ɵɵdirectiveInject(i4.SocketService), i0.ɵɵdirectiveInject(i5.FormBuilder)); };\nTaskModalComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: TaskModalComponent, selectors: [[\"task-modal\"]], hostVars: 2, hostBindings: function TaskModalComponent_HostBindings(rf, ctx) { if (rf & 2) {\n        i0.ɵɵclassMap(ctx.classes);\n    } }, decls: 3, vars: 3, consts: [[\"class\", \"task-modal-container\", 4, \"ngIf\"], [1, \"task-modal-backdrop\"], [1, \"task-modal-container\"], [1, \"task-modal-header\"], [1, \"task-modal-edit-title-form\", 3, \"defaultText\", \"title\", \"handleSubmit\"], [\"src\", \"/assets/close_icon.svg\", 1, \"task-modal-close\", 3, \"click\"], [1, \"task-modal-body\"], [1, \"column-select-container\", 3, \"formGroup\"], [\"formControlName\", \"columnId\", 1, \"column-select\"], [3, \"ngValue\", 4, \"ngFor\", \"ngForOf\"], [1, \"task-modal-description\"], [1, \"task-modal-description-label\"], [\"inputType\", \"textarea\", \"buttonText\", \"Save\", 1, \"task-modal-edit-description-form\", 3, \"defaultText\", \"title\", \"hasButton\", \"handleSubmit\"], [1, \"task-modal-actions\"], [1, \"task-modal-actions-label\"], [1, \"task-modal-actions-action\", 3, \"click\"], [\"src\", \"/assets/trash.svg\", 1, \"task-modal-actions-icon\"], [3, \"ngValue\"]], template: function TaskModalComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵtemplate(0, TaskModalComponent_div_0_Template, 20, 7, \"div\", 0);\n        i0.ɵɵpipe(1, \"async\");\n        i0.ɵɵelement(2, \"div\", 1);\n    } if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(1, 1, ctx.data$));\n    } }, directives: [i6.NgIf, i7.InlineFormComponent, i5.ɵNgNoValidate, i5.NgControlStatusGroup, i5.FormGroupDirective, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.FormControlName, i6.NgForOf, i5.NgSelectOption, i5.ɵNgSelectMultipleOption], pipes: [i6.AsyncPipe], encapsulation: 2 });\n"]},"metadata":{},"sourceType":"module"}